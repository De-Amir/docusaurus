<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>OPQ Makai · Open Power Quality</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="OPQ Makai · Open Power Quality"/><meta property="og:type" content="website"/><meta property="og:url" content="https://openpowerquality.org/index.html"/><meta property="og:description" content="OPQ Makai is a set of distributed services which together are responsible for aggregating and processing the measurements generated by the OPQBoxes. OPQ Makai is made up of three software components, each responsible for a specific task in the OPQ ecosystem. These components are:"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/opq.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://openpowerquality.org/blog/atom.xml" title="Open Power Quality Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://openpowerquality.org/blog/feed.xml" title="Open Power Quality Blog RSS Feed"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gugi"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/opqlogo_white.png" alt="Open Power Quality"/><h2 class="headerTitle">Open Power Quality</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/intro-motivation.html" target="_self">Documentation</a></li><li class="siteNavGroupActive"><a href="/docs/opportunities.html" target="_self">Opportunities</a></li><li class=""><a href="/blog" target="_self">News</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Software Services</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/docs/intro-motivation.html">Motivation for OPQ</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-opq.html">What is OPQ?</a></li></ul></div><div class="navGroup navGroupActive"><h3>User Guide</h3><ul><li class="navListItem"><a class="navItem" href="/docs/userguide-hardware.html">OPQ Box</a></li><li class="navListItem"><a class="navItem" href="/docs/userguide-software.html">OPQ View</a></li></ul></div><div class="navGroup navGroupActive"><h3>OPQ Box Hardware</h3><ul><li class="navListItem"><a class="navItem" href="/docs/box-overview.html">Design Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/box-manufacturing.html">Manufacturing</a></li></ul></div><div class="navGroup navGroupActive"><h3>Software Services</h3><ul><li class="navListItem"><a class="navItem" href="/docs/datamodel.html">Data Model</a></li><li class="navListItem"><a class="navItem" href="/docs/view.html">View</a></li><li class="navListItem"><a class="navItem" href="/docs/mauka.html">Mauka</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/makai.html">Makai</a></li><li class="navListItem"><a class="navItem" href="/docs/health.html">Health</a></li><li class="navListItem"><a class="navItem" href="/docs/protocol.html">Protocol</a></li><li class="navListItem"><a class="navItem" href="/docs/virtual-machine.html">VM &amp; Sim</a></li></ul></div><div class="navGroup navGroupActive"><h3>Deployment</h3><ul><li class="navListItem"><a class="navItem" href="/docs/deploy-initial-configuration.html">Initial Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-mauka.html">Mauka</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-makai.html">Makai</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-view.html">View</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-health.html">Health</a></li></ul></div><div class="navGroup navGroupActive"><h3>Developer Guide</h3><ul><li class="navListItem"><a class="navItem" href="/docs/developerguide-docusaurus.html">Documentation</a></li></ul></div><div class="navGroup navGroupActive"><h3>Other</h3><ul><li class="navListItem"><a class="navItem" href="/docs/roadmap.html">Roadmap</a></li><li class="navListItem"><a class="navItem" href="/docs/opportunities.html">R&amp;D Opportunities</a></li><li class="navListItem"><a class="navItem" href="/docs/agile-power-monitoring.html">Agile Power Monitoring for UH</a></li><li class="navListItem"><a class="navItem" href="/docs/g1-pilot-study.html">G1 Pilot Study (2014)</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>OPQ Makai</h1></header><article><div><span><p>OPQ Makai is a set of distributed services which together are responsible for aggregating and processing the measurements generated by the OPQBoxes. OPQ Makai is made up of three software components, each responsible for a specific task in the OPQ ecosystem. These components are:</p>
<ul>
<li>Triggering Broker.</li>
<li>Acquisition Broker.</li>
<li>Triggering Service.</li>
</ul>
<p>Makai system uses <a href="http://zeromq.org/">0MQ</a> for transport and <a href="https://developers.google.com/protocol-buffers/">protobuf</a> for serialization. This allows easy integration with heterogeneous and polylingual systems, such as OPQ Mauka and OPQ View.The block diagram of Makai components is shown bellow:</p>
<p><img src="/docs/assets/makai/makai_main.svg"></p>
<h2><a class="anchor" aria-hidden="true" id="triggering-broker"></a><a href="#triggering-broker" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Triggering Broker</h2>
<p>Triggering broker is used as an endpoint for the feature reduced data generated by the OPQBox devices. Furthermore, it serves as a endpoint for the rest of the OPQ infrastructure for receiving OPQBox triggering stream. It receives frequency, Vrms and THD measurements from the OPQBox and forwards them to the connected clients. Every client is authenticated using the 0MQ security suite CurveMQ. In order to do that, a public key of every OPQBox must be provided to the TriggeringBroker at startup. Furthermore in order to authenticate the TriggeringBroker it's public key is distributed to every OPQBox. Triggeringbroker uses a SUB socket pair for receiving data from the box and a PUB socket from forwarding data further down the line.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration"></a><a href="#configuration" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<p>By default triggering broker will look for it's configuration file in <code>/etc/opq/triggering_broker.json</code> A default configuration file is shown below:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"client_certs"</span>: <span class="hljs-string">"/etc/opq/curve/public_keys"</span>,
  <span class="hljs-attr">"server_cert"</span>: <span class="hljs-string">"/etc/opq/curve/private_keys/opqserver_secret"</span>,
  <span class="hljs-attr">"interface"</span>: <span class="hljs-string">"tcp://*:9880"</span>,
  <span class="hljs-attr">"backend"</span> : <span class="hljs-string">"tcp://*:9881"</span>
}
</code></pre>
<p>Fields are as follows:</p>
<ul>
<li><em>client_cert</em> : directory containing public keys of the OPQBoxes.</li>
<li><em>server_cert</em> : private key of the Triggering Broker.</li>
<li><em>interface</em> : endpoint for the OPQBox.</li>
<li><em>backend</em> : endpoint for the cloud infrastructure</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="interface"></a><a href="#interface" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface</h3>
<p>In order to communicate with the triggering broker, connect to backend port with using ZMQ SUB socket with a language of your choice and subscribe to OPQBox2 IDs you would like to receive data from. Alternatively and empty subscription will receive data from all devices. Each message contains two frames. The first frame is the box id encoded as a string. The second frame contains a protobuf encoded TriggerMessage described in the <a href="/docs/protocol.html">Protocol</a> section.</p>
<h2><a class="anchor" aria-hidden="true" id="acquisition-broker"></a><a href="#acquisition-broker" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Acquisition Broker</h2>
<p>Acquisition Broker is a microservice responsible for raw waveform acquisition from the OPQBoxes. Similarly to the triggering broker, all communication between OPQBox and acquisition broker is authenticated and encrypted using the CurveMQ. The diagram of the acquisiton broker interfaces is shown below:</p>
<p><img src="/docs/assets/makai/acq_brk.png"></p>
<p>OPQBoxes connect to the acquisition broker's PUB interface and wait for a raw data requests. Once a raw data request arrives it is forwarded to the acquisition broker via the PULL interface. Raw waveform data as well as the event request are logged in the MongoDB. For Mongodb schema data model examine the <a href="/docs/datamodel.html">Data Model</a> section.</p>
<h3><a class="anchor" aria-hidden="true" id="configuration"></a><a href="#configuration" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration</h3>
<p>By default acquisition broker will attempt to load a configuration file located in <code>/etc/opq/acquisition_broker_config.json</code>. Alternatively a configuration file can be passed as a command line argument.</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"client_certs"</span>: <span class="hljs-string">"/etc/opq/curve/public_keys"</span>,
  <span class="hljs-attr">"server_cert"</span>: <span class="hljs-string">"/etc/opq/curve/private_keys/opqserver_secret"</span>,
  <span class="hljs-attr">"box_pub"</span>: <span class="hljs-string">"tcp://*:8194"</span>,
  <span class="hljs-attr">"box_pull"</span>: <span class="hljs-string">"tcp://*:8196"</span>,
  <span class="hljs-attr">"backend_pull"</span>: <span class="hljs-string">"tcp://*:9884"</span>,
  <span class="hljs-attr">"backend_pub"</span>: <span class="hljs-string">"tcp://*:9882"</span>,
  <span class="hljs-attr">"mongo_uri"</span>: <span class="hljs-string">"mongodb://localhost:27017"</span>
}
</code></pre>
<p>The fields are as follows:</p>
<ul>
<li><em>client_certs</em> : path to directory containing OPQBox public keys.</li>
<li><em>server_cert</em> : path to the server private key.</li>
<li><em>box_pub</em> : a PUB interface for OPQBox.</li>
<li><em>box_pull</em> : a PULL interface for the OPQBox.</li>
<li><em>backend_pull</em> : an OPQHub PULL endpoint.</li>
<li><em>backend_pub</em> : an OPQHub PUB endpoint.</li>
<li><em>mongo_uri</em> : mongo host and port.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="interface"></a><a href="#interface" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface:</h3>
<p>In oder to initiate an event acquisition a client connects to the Acquisition broker's PULL interface and send it a protobuf encoded <a href="/docs/protocol.html">ReqtestDataMessage</a>. Furthermore any client connected to the PUB interface will be notified of a new event by receiving a text encoded event number.</p>
<h2><a class="anchor" aria-hidden="true" id="triggering-service"></a><a href="#triggering-service" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Triggering Service</h2>
<p>Triggering service is responsible for analyzing the triggering streams from the OPQBoxes and requesting raw waveforms whenever an anomaly is detected. Furthermore the acquisition service maintains the measurements and trends <a href="/docs/datamodel.html">collections</a>. Measurements are a copy of the measurement stream, maintained in the database over 24 hour interval, while trends are persistent averages of the measurements stream over a 1 minute window. The triggering service does not have any inherent logic for triggering stream analysis. Instead, it relies on analysis plugins loaded form dynamic libraries to analyse the incoming measurements and locate anomalies. This allows multiple analysis As such the Triggering service consists of three parts:</p>
<ul>
<li><em>makai daemon</em> : the daemon responsible for measurements acquisition, plugin managements and communication with the acquisition service.</li>
<li><em>opqapi shard library</em> : a shared library that defines the plugin interface and communication data structures.</li>
<li><em>plugins</em> : a set of dynamic libraries which implements the plugin interface responsible for the triggering stream analysis.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="configuring-triggering-service"></a><a href="#configuring-triggering-service" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring Triggering Service.</h3>
<p>makai daemon will look for it's configuration file in <code>/etc/opq/makai.conf</code>, unless it's passed in as a command line argument. A typical configuration for the triggering service is shown bellow:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"zmq_trigger_endpoint"</span> : <span class="hljs-string">"tcp://127.0.0.1:9881"</span>,
  <span class="hljs-attr">"zmq_acquisition_endpoint"</span> : <span class="hljs-string">"tcp://127.0.0.1:9881"</span>,
  <span class="hljs-attr">"mongo_host"</span> : <span class="hljs-string">"localhost"</span>,
  <span class="hljs-attr">"mongo_port"</span> : <span class="hljs-number">27017</span>,
  <span class="hljs-attr">"mongo_measurement_expiration_seconds"</span> : <span class="hljs-number">86400</span>,
  <span class="hljs-attr">"mongo_trends_update_interval_seconds"</span> : <span class="hljs-number">60</span>,
  <span class="hljs-attr">"event_request_expiration_window_ms"</span> : <span class="hljs-number">1800000</span>,
  <span class="hljs-attr">"plugins"</span> : [
    {
      <span class="hljs-attr">"path"</span> : <span class="hljs-string">"/usr/local/lib/opq/plugins/libketos_plugin.so"</span>,
      <span class="hljs-attr">"script_path"</span> : <span class="hljs-string">"./main.ket"</span>
    }
  ]
}
</code></pre>
<p>The list of fields is shown below:</p>
<ul>
<li><em>zmq_trigger_endpoint</em> : triggering service endpoint.</li>
<li><em>zmq_acquisition_endpoint</em> : acquisition broker end point.</li>
<li><em>mongo_host</em> : mongo db host.</li>
<li><em>mongo_port</em> : mongo db port.</li>
<li><em>mongo_measurement_expiration_seconds</em>  : how long the measurements persist in mongo.</li>
<li><em>mongo_trends_update_interval_seconds</em> : the window width for trend averaging.</li>
<li><em>event_request_expiration_window_ms</em>  :   internal do not change.</li>
<li><em>plugins</em> : a list of plugins with object specific settings. The path field is required.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="developing-new-plugins-in-rust"></a><a href="#developing-new-plugins-in-rust" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developing new plugins in Rust.</h3>
<p>Triggering service is developed in <a href="www.rust-lang.org">Rust</a> programing language. As such the most straight forward way to develop triggering service plugins is using the Rust programing language. An simple example of a plugin writen in Rust is found <a href="https://github.com/openpowerquality/opq/blob/master/makai/TriggeringService/plugins/print/src/lib.rs">here</a>. The only requirement for a plugin is a struct that implements the <a href="https://github.com/openpowerquality/opq/blob/master/makai/TriggeringService/opqapi/src/makaiplugin/mod.rs">MakaiPlugin</a> traits, and that the library includes the <code>declare_plugin!</code> macro for bringing this struct across the rust FFI boundary into the daemon type system. Not that the data types <code>TriggerMessage</code> and <code>RequestEventMessage</code> are auto-generated by protobuf and their description can be found in the <a href="/docs/protocol.html">protocol</a> section.</p>
<h3><a class="anchor" aria-hidden="true" id="developing-new-plugins-in-c-c"></a><a href="#developing-new-plugins-in-c-c" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developing new plugins in C/C++</h3>
<p>Since Rust FFI is designed to interoperate with C/C++ it is quite easy to develop analysis plugins in C/C++. The only requirement is a Rust shim which implements the correct traits and defines the translation between the rust and C/C++ types.</p>
<h3><a class="anchor" aria-hidden="true" id="developing-new-plugins-in-x-language"></a><a href="#developing-new-plugins-in-x-language" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developing new plugins in X language.</h3>
<p>For a natively compiled language, as long as the language has a C/C++ binding that binding can interplay with rust. Again the only requirement is a Rust shim which translates the rust types into C/C++ types and finally into the types of a language of your choice. Many interpreted languages such as Python and JS have rust bindings for their virtual machines. An example of embedding a VM into the triggering service plugin is shown <a href="https://github.com/openpowerquality/opq/blob/master/makai/TriggeringService/plugins/ketos/">here</a>. Here a lisp VM is embedded into the rust plugin which provides type translation and runtime for lisp <a href="https://github.com/openpowerquality/opq/blob/master/makai/TriggeringService/plugins/ketos/main.ket">scripts</a> to perform analysis and triggering. A similar plugin can be developed for any interpreted language with rust bindings.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="mauka.html">← OPQ Mauka</a><a class="docs-next button" href="health.html">OPQ Health →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#triggering-broker">Triggering Broker</a><ul class="toc-headings"><li><a href="#configuration">Configuration</a></li><li><a href="#interface">Interface</a></li></ul></li><li><a href="#acquisition-broker">Acquisition Broker</a><ul class="toc-headings"><li><a href="#configuration">Configuration</a></li><li><a href="#interface">Interface:</a></li></ul></li><li><a href="#triggering-service">Triggering Service</a><ul class="toc-headings"><li><a href="#configuring-triggering-service">Configuring Triggering Service.</a></li><li><a href="#developing-new-plugins-in-rust">Developing new plugins in Rust.</a></li><li><a href="#developing-new-plugins-in-c-c">Developing new plugins in C/C++</a></li><li><a href="#developing-new-plugins-in-x-language">Developing new plugins in X language.</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/opqlogo_white.png" alt="Open Power Quality" width="66" height="58"/></a><div><h5>Documentation Quick Links</h5><a href="/docs/intro-opq.html">Overview</a><a href="/docs/userguide-hardware.html">OPQ Box User Guide</a><a href="/docs/userguide-software.html">OPQ View User Guide</a><a href="/docs/agile-power-monitoring.html">Agile Power Monitoring for UH</a><a href="/docs/roadmap.html">Roadmap</a></div><div><h5>Community</h5><a href="https://openpowerquality.slack.com/" target="_blank" rel="noreferrer noopener">Slack</a><a href="https://twitter.com/opquality" target="_blank" rel="noreferrer noopener">Twitter</a><a href="/blog">News</a><a href="http://emilia.ics.hawaii.edu">Emilia (public OPQ View)</a><a href="/contact-us.html">Contact Us</a></div><div><h5>Development</h5><a href="https://github.com/openpowerquality">GitHub</a><a href="https://github.com/openpowerquality/opq/projects/1">Project Board</a><a href="/team.html">Developer Team</a><a href="/docs/opportunities.html">Opportunities</a><a href="http://www.citeulike.org/group/3370/tag/powerquality">Publications</a></div></section><p style="text-align:center;color:#e9faff;">Open Power Quality is sponsored by:<br/><a style="text-align:center;color:#e9faff;" href="http://csdl.ics.hawaii.edu">Collaborative Software Development Laboratory, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff;" href="http://www.ics.hawaii.edu">Department of Information and Computer Sciences, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff;" href="http://ee.hawaii.edu">Department of Electrical Engineering, University of Hawaii</a><br/></p></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '9bf16cc78135dbeeb3826894ebbbb2ee',
                indexName: 'openpowerquality',
                inputSelector: '#search_input_react'
              });
            </script></body></html>